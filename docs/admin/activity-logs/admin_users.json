{
    "openapi": "3.0.3",
    "info": {
        "title": "PMII API - Admin Activity Logs Module",
        "description": "API Contract untuk modul Admin Activity Logs.\nSemua endpoint dalam modul ini **hanya dapat diakses oleh Admin**.\nMemerlukan autentikasi menggunakan Bearer Token JWT.",
        "version": "1.0.0",
        "contact": {
            "name": "PMII Development Team"
        }
    },
    "servers": [
        {
            "url": "/v1",
            "description": "API Version 1"
        }
    ],
    "tags": [
        {
            "name": "Admin Activity Logs",
            "description": "Audit aktivitas admin dan author"
        }
    ],
    "security": [
        {
            "BearerAuth": []
        }
    ],
    "paths": {
        "/admin/activity-logs": {
            "get": {
                "tags": [
                    "Admin Activity Logs"
                ],
                "summary": "Get All Activity Logs",
                "description": "Mengambil daftar semua activity log dengan pagination dan filter.\n**Hanya dapat diakses oleh Admin.**",
                "operationId": "getAllActivityLogs",
                "parameters": [
                    {
                        "name": "page",
                        "in": "query",
                        "description": "Nomor halaman (default: 1)",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "default": 1,
                            "minimum": 1,
                            "example": 1
                        }
                    },
                    {
                        "name": "limit",
                        "in": "query",
                        "description": "Jumlah item per halaman (default: 30, max: 100)",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "default": 30,
                            "minimum": 1,
                            "maximum": 100,
                            "example": 30
                        }
                    },
                    {
                        "name": "user_id",
                        "in": "query",
                        "description": "Filter berdasarkan ID user",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "minimum": 1,
                            "example": 1
                        }
                    },
                    {
                        "name": "module",
                        "in": "query",
                        "description": "Filter berdasarkan module",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "user",
                                "post",
                                "category",
                                "tags",
                                "testimoni",
                                "members",
                                "teams",
                                "dokumen",
                                "settings",
                                "auth"
                            ],
                            "example": "post"
                        }
                    },
                    {
                        "name": "action_type",
                        "in": "query",
                        "description": "Filter berdasarkan tipe aksi",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "create",
                                "read",
                                "update",
                                "delete",
                                "login",
                                "logout"
                            ],
                            "example": "create"
                        }
                    },
                    {
                        "name": "start_date",
                        "in": "query",
                        "description": "Filter dari tanggal (format: YYYY-MM-DD)",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "date",
                            "example": "2025-12-01"
                        }
                    },
                    {
                        "name": "end_date",
                        "in": "query",
                        "description": "Filter sampai tanggal (format: YYYY-MM-DD)",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "date",
                            "example": "2025-12-31"
                        }
                    },
                    {
                        "name": "search",
                        "in": "query",
                        "description": "Pencarian di field description",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "example": "password"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Berhasil mengambil data activity logs",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "allOf": [
                                        {
                                            "$ref": "#/components/schemas/SuccessResponseWithPagination"
                                        },
                                        {
                                            "type": "object",
                                            "properties": {
                                                "data": {
                                                    "type": "array",
                                                    "items": {
                                                        "$ref": "#/components/schemas/ActivityLogResponse"
                                                    }
                                                }
                                            }
                                        }
                                    ]
                                },
                                "example": {
                                    "meta": {
                                        "code": 200,
                                        "status": "success",
                                        "message": "Activity logs berhasil dimuat",
                                        "pagination": {
                                            "page": 1,
                                            "limit": 30,
                                            "total": 150,
                                            "lastPage": 5
                                        }
                                    },
                                    "data": [
                                        {
                                            "id": 1,
                                            "user_id": 1,
                                            "user": {
                                                "id": 1,
                                                "full_name": "Admin PMII",
                                                "email": "admin@pmii.or.id"
                                            },
                                            "action_type": "create",
                                            "module": "post",
                                            "description": "Created new post: Sejarah PMII",
                                            "target_id": 123,
                                            "old_value": null,
                                            "new_value": {
                                                "title": "Sejarah PMII"
                                            },
                                            "ip_address": "192.168.1.1",
                                            "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
                                            "created_at": "2025-12-30T09:00:00Z"
                                        },
                                        {
                                            "id": 2,
                                            "user_id": 1,
                                            "user": {
                                                "id": 1,
                                                "full_name": "Admin PMII",
                                                "email": "admin@pmii.or.id"
                                            },
                                            "action_type": "update",
                                            "module": "user",
                                            "description": "Changed password for user: John Doe",
                                            "target_id": 5,
                                            "old_value": null,
                                            "new_value": null,
                                            "ip_address": "192.168.1.1",
                                            "user_agent": "Mozilla/5.0",
                                            "created_at": "2025-12-30T08:30:00Z"
                                        }
                                    ]
                                }
                            }
                        }
                    },
                    "401": {
                        "$ref": "#/components/responses/UnauthorizedError"
                    },
                    "403": {
                        "$ref": "#/components/responses/ForbiddenError"
                    },
                    "500": {
                        "$ref": "#/components/responses/InternalServerError"
                    }
                }
            }
        }
    },
    "components": {
        "securitySchemes": {
            "BearerAuth": {
                "type": "http",
                "scheme": "bearer",
                "bearerFormat": "JWT",
                "description": "JWT Token dari endpoint login. Format header: `Authorization: Bearer <token>`"
            }
        },
        "schemas": {
            "Meta": {
                "type": "object",
                "properties": {
                    "code": {
                        "type": "integer",
                        "description": "HTTP status code",
                        "example": 200
                    },
                    "status": {
                        "type": "string",
                        "enum": [
                            "success",
                            "error"
                        ],
                        "description": "Status response",
                        "example": "success"
                    },
                    "message": {
                        "type": "string",
                        "description": "Pesan response",
                        "example": "Activity logs berhasil dimuat"
                    }
                }
            },
            "Pagination": {
                "type": "object",
                "properties": {
                    "page": {
                        "type": "integer",
                        "description": "Halaman saat ini",
                        "example": 1
                    },
                    "limit": {
                        "type": "integer",
                        "description": "Jumlah item per halaman",
                        "example": 30
                    },
                    "total": {
                        "type": "integer",
                        "format": "int64",
                        "description": "Total semua item",
                        "example": 150
                    },
                    "lastPage": {
                        "type": "integer",
                        "description": "Halaman terakhir",
                        "example": 5
                    }
                }
            },
            "SuccessResponseWithPagination": {
                "type": "object",
                "properties": {
                    "meta": {
                        "allOf": [
                            {
                                "$ref": "#/components/schemas/Meta"
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "pagination": {
                                        "$ref": "#/components/schemas/Pagination"
                                    }
                                }
                            }
                        ]
                    },
                    "data": {
                        "type": "array",
                        "items": {}
                    }
                }
            },
            "ErrorResponse": {
                "type": "object",
                "properties": {
                    "meta": {
                        "$ref": "#/components/schemas/Meta"
                    },
                    "data": {
                        "type": "object",
                        "nullable": true,
                        "example": null
                    }
                }
            },
            "ActivityLogUserInfo": {
                "type": "object",
                "description": "Informasi user yang melakukan aktivitas",
                "properties": {
                    "id": {
                        "type": "integer",
                        "description": "ID user",
                        "example": 1
                    },
                    "full_name": {
                        "type": "string",
                        "description": "Nama lengkap user",
                        "example": "Admin PMII"
                    },
                    "email": {
                        "type": "string",
                        "format": "email",
                        "description": "Email user",
                        "example": "admin@pmii.or.id"
                    }
                }
            },
            "ActivityLogResponse": {
                "type": "object",
                "description": "Object activity log",
                "properties": {
                    "id": {
                        "type": "integer",
                        "description": "ID activity log",
                        "example": 1
                    },
                    "user_id": {
                        "type": "integer",
                        "description": "ID user yang melakukan aksi",
                        "example": 1
                    },
                    "user": {
                        "$ref": "#/components/schemas/ActivityLogUserInfo"
                    },
                    "action_type": {
                        "type": "string",
                        "enum": [
                            "create",
                            "read",
                            "update",
                            "delete",
                            "login",
                            "logout"
                        ],
                        "description": "Tipe aksi yang dilakukan",
                        "example": "create"
                    },
                    "module": {
                        "type": "string",
                        "enum": [
                            "user",
                            "post",
                            "category",
                            "tags",
                            "testimoni",
                            "members",
                            "teams",
                            "dokumen",
                            "settings",
                            "auth"
                        ],
                        "description": "Module tempat aksi dilakukan",
                        "example": "post"
                    },
                    "description": {
                        "type": "string",
                        "nullable": true,
                        "description": "Deskripsi aktivitas",
                        "example": "Created new post: Sejarah PMII"
                    },
                    "target_id": {
                        "type": "integer",
                        "nullable": true,
                        "description": "ID entitas yang menjadi target aksi",
                        "example": 123
                    },
                    "old_value": {
                        "type": "object",
                        "nullable": true,
                        "description": "Nilai sebelum perubahan (untuk update)",
                        "example": {
                            "title": "Old Title"
                        }
                    },
                    "new_value": {
                        "type": "object",
                        "nullable": true,
                        "description": "Nilai setelah perubahan (untuk create/update)",
                        "example": {
                            "title": "New Title"
                        }
                    },
                    "ip_address": {
                        "type": "string",
                        "nullable": true,
                        "description": "IP address user",
                        "example": "192.168.1.1"
                    },
                    "user_agent": {
                        "type": "string",
                        "nullable": true,
                        "description": "User agent browser",
                        "example": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
                    },
                    "created_at": {
                        "type": "string",
                        "format": "date-time",
                        "description": "Waktu aktivitas",
                        "example": "2025-12-30T09:00:00Z"
                    }
                }
            }
        },
        "responses": {
            "UnauthorizedError": {
                "description": "Unauthorized - Token tidak valid atau tidak ada",
                "content": {
                    "application/json": {
                        "schema": {
                            "$ref": "#/components/schemas/ErrorResponse"
                        },
                        "example": {
                            "meta": {
                                "code": 401,
                                "status": "error",
                                "message": "Akses ditolak - Token tidak valid"
                            },
                            "data": null
                        }
                    }
                }
            },
            "ForbiddenError": {
                "description": "Forbidden - Tidak memiliki akses ke resource ini",
                "content": {
                    "application/json": {
                        "schema": {
                            "$ref": "#/components/schemas/ErrorResponse"
                        },
                        "example": {
                            "meta": {
                                "code": 403,
                                "status": "error",
                                "message": "Akses ditolak - Hanya admin yang dapat mengakses"
                            },
                            "data": null
                        }
                    }
                }
            },
            "InternalServerError": {
                "description": "Internal Server Error",
                "content": {
                    "application/json": {
                        "schema": {
                            "$ref": "#/components/schemas/ErrorResponse"
                        },
                        "example": {
                            "meta": {
                                "code": 500,
                                "status": "error",
                                "message": "Gagal mengambil data activity logs"
                            },
                            "data": null
                        }
                    }
                }
            }
        }
    }
}